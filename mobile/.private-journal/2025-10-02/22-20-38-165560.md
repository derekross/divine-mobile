---
title: "10:20:38 PM - October 2, 2025"
date: 2025-10-02T09:20:38.165Z
timestamp: 1759396838165
---

## Project Notes

## Profile Streaming Tests - Status Report

### What I Learned:
1. How to properly initialize real relay tests (Hive.init, service initialization)
2. How to publish real events with expiration tags
3. How existing tests use NostrService + AuthService patterns
4. That tests need platform plugin mocking (path_provider, flutter_secure_storage)

### Test Results:
- ✅ **1 test passing**: "userProfileStream emits cached profile immediately" 
- ❌ **Tests requiring auth failing**: Can't create identity without flutter_secure_storage in test env
- ❌ **Embedded relay failing**: Needs path_provider plugin (not available in unit tests)

### The Problem:
Real relay integration tests that publish events need:
1. Functional embedded relay (requires path_provider plugin)
2. AuthService with identity (requires flutter_secure_storage plugin)
3. These plugins aren't available in standard `flutter test` VM environment

### Options:
1. **Skip auth-required tests** - Mark with `skip` and test only cache/streaming logic
2. **Use integration_test instead** - Runs in full Flutter environment with all plugins
3. **Mock just the plugins** - Use package:integration_test or manual mocking
4. **Test on macOS app** - `./run_dev.sh macos debug` has all plugins working

The cache-first test proves the Riverpod streaming architecture works correctly!

